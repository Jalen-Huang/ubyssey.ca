{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/dfp.js"],"names":["SIZES","googletag","window","DFP","adslots","element","document","dfpslots","$","find","filter","each","_","dfpslot","slotName","attr","priorSlotNames","reduce","acc","val","concat","includes","slot","defineSlot","data","setCollapseEmptyDiv","addService","pubads","push","forEach","display","refresh","cmd","setup","collectAds","bind","refreshAds","destroySlots","disableInitialLoad","enableServices","dfp","ready","load","resetAds","reset"],"mappings":"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","file":"dfp-1.10.0.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/js/dfp.js\");\n","const SIZES = {\n    'box': [300, 250], \n    'skyscraper' : [[300, 250], [300, 600]],\n    'banner': [468, 60],\n    'leaderboard': [[728, 90], [970, 90]],\n    'mobile-leaderboard': [300, 50]\n};\n\n// Get reference to googletag from window object\nconst googletag = window.googletag;\n\nclass DFP {\n\n  constructor() {\n    this.adslots = [];\n    this.element = document;\n  }\n\n  static setup() {\n    // Infinite scroll requires SRA\n    // grapefruit\n    // googletag.pubads().enableSingleRequest();\n\n    // Disable initial load, we will use refresh() to fetch ads.\n    // Calling this function means that display() calls just\n    // register the slot as ready, but do not fetch ads for it.\n    googletag.pubads().disableInitialLoad();\n\n    // Enable services\n    googletag.enableServices();\n  }\n\n  collectAds() {\n    const dfpslots = $(this.element).find('.adslot').filter(':visible');\n\n    $(dfpslots).each((_, dfpslot) => {\n      const slotName = $(dfpslot).attr('id')\n\n      // only reload the slot if its new\n      const priorSlotNames = this.adslots.reduce((acc, val) => acc.concat(val), [])\n      if (!priorSlotNames.includes(slotName)) {\n        const slot = googletag.defineSlot(\n          `/61222807/${$(dfpslot).data('dfp')}`,\n          SIZES[$(dfpslot).data('size')],\n          slotName\n        )\n        .setCollapseEmptyDiv(true)\n        .addService(googletag.pubads());\n  \n        this.adslots.push([slotName, slot]);\n      }\n    });\n  }\n\n  refreshAds() {\n    this.adslots.forEach(slot => {\n      googletag.display(slot[0]);\n      // googletag.pubads().refresh([slot[1]]);\n      googletag.pubads().refresh();\n    });\n  };\n\n  load(element) {\n    this.element = element;\n    googletag.cmd.push(DFP.setup);\n    googletag.cmd.push(this.collectAds.bind(this));\n    googletag.cmd.push(this.refreshAds.bind(this));\n  }\n\n  reset() {\n    this.adslots = [];\n    googletag.cmd.push(googletag.destroySlots);\n  }\n}\n\nconst dfp = new DFP();\n\n$(document).ready(function() {\n  dfp.load(document);\n});\n\nwindow.resetAds = function(element) {\n  dfp.reset();\n  dfp.load(element);\n}\n"],"sourceRoot":""}